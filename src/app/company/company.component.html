<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto" />
<link
  rel="stylesheet"
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/icon?family=Material+Icons"
/>
<link
  rel="stylesheet"
  href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
/>

<div>
  <div class="container-xl">
    <div class="table-responsive">
      <div class="table-wrapper">
        <div class="table-title">
          <div class="row">
            <div class="col-sm-0">
              <h2>Company Details</h2>
            </div>
            <div class="col-sm-10">
              <div
                class="btn-group"
                role="group"
                aria-label="Button group with nested dropdown"
              >
                <button
                  type="button"
                  class="btn btn-sm btn-link"
                  data-toggle="modal"
                  data-target="#addModal"
                >
                  New Company
                </button>
                <button type="button" class="btn btn-sm btn-link">Print</button>
                <div class="btn-group" role="group">
                  <button
                    id="btnGroupDrop1"
                    type="button"
                    class="btn btn-sm btn-link dropdown-toggle"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                  >
                    Export
                  </button>
                  <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                    <a class="dropdown-item" href="#">Excel</a>
                    <a class="dropdown-item" href="#">Csv</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="search-box">
                <i class="material-icons">&#xE8B6;</i>
                <input
                  type="text"
                  class="form-control"
                  placeholder="Search&hellip;"
                />
              </div>
            </div>
          </div>
        </div>
        <table class="table table-striped table-hover table-bordered">
          <thead>
            <tr>
              <th>#</th>
              <th>Address</th>
              <th>Email</th>
              <th>GstNo<i class="fa fa-sort"></i></th>
              <th>IsActive</th>
              <th>Phone</th>
              <th>Title</th>
              <th>Website</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="
                let company of companyResponse | paginate: config;
                let indexOfelement = index
              "
            >
              <td>{{ indexOfelement + 1 }}</td>
              <td>{{ company.address }}</td>
              <td>{{ company.email }}</td>
              <td>{{ company.gstNo }}</td>
              <td>{{ company.isActive }}</td>
              <td>{{ company.Phone }}</td>
              <td>{{ company.title }}</td>
              <td>{{ company.Website }}</td>
              <td>
                <a
                  href="#"
                  data-toggle="modal"
                  data-target="#editModal"
                  (click)="modifyRecord(trip)"
                  class="edit"
                  title="Edit"
                  ><i class="material-icons">&#xE254;</i></a
                >
                <a
                  href="#"
                  data-toggle="modal"
                  (click)="deleteRecord(trip)"
                  data-target="#viewModal"
                  class="delete"
                  title="Delete"
                  ><i class="material-icons">&#xE872;</i></a
                >
              </td>
            </tr>
          </tbody>
        </table>
        <div class="clearfix">
          <div *ngIf="tripResponse != undefined" class="hint-text">
            Showing <b>{{ config.itemsPerPage }}</b> out of
            <b>{{ tripResponse.length }}</b> entries
          </div>
          <pagination-controls
            (pageChange)="pageChange($event)"
            class="my-pagination pagination"
          ></pagination-controls>
        </div>
      </div>
    </div>
    <!--Container-->
  </div>
</div>

<!-- Edit Modal -->
<div
  class="modal fade"
  id="editModal"
  data-backdrop="static"
  data-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-xl" *ngIf="currentUpdateTrip != undefined">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">
          Editing {{ currentUpdateTrip.triptTitle }}
        </h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-row">
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="currentUpdateTrip.companyId"
                name="companyId"
                id="companyId"
                class="form-control"
                placeholder="companyId"
                (change)="currentUpdateTrip.companyChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="currentUpdateTrip.departmentId"
                name="departmentId"
                id="departmentId"
                class="form-control"
                (change)="currentUpdateTrip.departmentChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.driverId"
                name="driverId"
                id="driverId"
                placeholder="driverId"
                (change)="currentUpdateTrip.driverChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.firstPickTime"
                name="firstPickTime"
                id="firstPickTime"
                placeholder="firstPickTime"
                (change)="currentUpdateTrip.tripInfoChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.firstPickUpPoint"
                name="firstPickUpPoint"
                id="firstPickUpPoint"
                placeholder="firstPickUpPoint"
                (change)="currentUpdateTrip.tripInfoChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.lastDroPoint"
                name="lastDroPoint"
                id="lastDroPoint"
                placeholder="lastDroPoint"
                (change)="currentUpdateTrip.tripInfoChangeRequired = true"
              />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.packageId"
                name="packageId"
                id="packageId"
                placeholder="packageId"
                (change)="currentUpdateTrip.packageChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.triptTitle"
                name="triptTitle"
                id="triptTitle"
                placeholder="triptTitle"
                (change)="currentUpdateTrip.tripInfoChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.vehicleId"
                name="vehicleId"
                id="vehicleId"
                placeholder="vehicleId"
                (change)="currentUpdateTrip.vehicleChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.reasonForChange"
                name="reasonForChange"
                id="reasonForChange"
                placeholder="reasonForChange"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                class="form-control"
                [(ngModel)]="currentUpdateTrip.status"
                name="status"
                id="status"
                placeholder="status"
                (change)="currentUpdateTrip.statusChangeRequired = true"
              />
            </div>
            <div class="form-group col-md-2"></div>
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>#</th>
                  <th>First Name</th>
                  <th>Last Name</th>
                  <th>Phone</th>
                  <th>Pickup Point</th>
                  <th>Pickup TIme</th>
                  <th>Drop Point</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="
                    let rider of currentUpdateTrip.riders;
                    let count = index
                  "
                >
                  <td>{{ count + 1 }}</td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      [(ngModel)]="rider.firstName"
                      name="{{ count + 1 }}firstName"
                      id="{{ count + 1 }}firstName"
                      placeholder="firstName"
                      (change)="currentUpdateTrip.riderChangeRequired = true"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      [(ngModel)]="rider.lastName"
                      name="{{ count + 1 }}lastName"
                      id="{{ count + 1 }}lastName"
                      placeholder="lastName"
                      (change)="currentUpdateTrip.riderChangeRequired = true"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      [(ngModel)]="rider.phone"
                      name="{{ count + 1 }}phone"
                      id="{{ count + 1 }}phone"
                      placeholder="phone"
                      (change)="currentUpdateTrip.riderChangeRequired = true"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      [(ngModel)]="rider.pickPoint"
                      name="{{ count + 1 }}pickPoint"
                      id="{{ count + 1 }}pickPoint"
                      placeholder="pickPoint"
                      (change)="currentUpdateTrip.riderChangeRequired = true"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      [(ngModel)]="rider.pickDateTime"
                      name="{{ count + 1 }}pickDateTime"
                      id="{{ count + 1 }}pickDateTime"
                      placeholder="pickDateTime"
                      (change)="currentUpdateTrip.riderChangeRequired = true"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      [(ngModel)]="rider.dropPoint"
                      name="{{ count + 1 }}dropPoint"
                      id="{{ count + 1 }}dropPoint"
                      placeholder="dropPoint"
                      (change)="currentUpdateTrip.riderChangeRequired = true"
                    />
                  </td>
                  <td>
                    <a
                      class="add"
                      (click)="addNewUpdateRider()"
                      title="Add Rider"
                      ><i class="material-icons">&#xE03B;</i></a
                    >
                    <a
                      class="delete"
                      (click)="deleteNewlyAddedRiderFromUpdate(rider)"
                      title="Delete"
                      ><i class="material-icons">&#xE872;</i></a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          Cancel
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="updateTripToDb()"
        >
          Update Record
        </button>
      </div>
      <pre *ngIf="isDebugMode && currentUpdateTrip != undefined">
 {{ currentUpdateTrip | json }} </pre
      >
    </div>
  </div>
</div>

<!--add modal-->
<div
  class="modal fade"
  id="addModal"
  data-backdrop="static"
  data-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Edit</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" *ngIf="createCompany != undefined">
        <form>
          <div class="form-row">
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="createCompany.address"
                name="address"
                class="form-control"
                placeholder="Address"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="createCompany.email"
                name="email"
                class="form-control"
                placeholder="email"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="createCompany.gstNo"
                name="gstNo"
                class="form-control"
                placeholder="GstNO"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="createCompany.isActive"
                name="isActive"
                class="form-control"
                placeholder="IsActive"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="createCompany.phone"
                name="phone"
                class="form-control"
                placeholder="Phone"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="createCompany.title"
                name="title"
                class="form-control"
                placeholder="Title"
              />
            </div>
            <div class="form-group col-md-2">
              <input
                type="text"
                [(ngModel)]="createCompany.website"
                name="website"
                class="form-control"
                placeholder="Website"
              />
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          Cancel
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="createNewCompany()"
        >
          Add Record
        </button>
      </div>
      <pre *ngIf="isDebugMode"> {{ createCompany | json }} </pre>
    </div>
  </div>
</div>
